[gd_scene load_steps=45 format=3 uid="uid://d0qfe71ghlydg"]

[ext_resource type="Texture2D" uid="uid://d3w32ge402igv" path="res://panorama/purple_nebula.png" id="1_lgks0"]
[ext_resource type="Script" path="res://scene/OrbitAnchor.gd" id="3_2ho2d"]
[ext_resource type="PackedScene" uid="uid://bbt8wyhyebw1u" path="res://scene/star.tscn" id="3_ry3cy"]
[ext_resource type="PackedScene" uid="uid://cuj7u8bw2mn73" path="res://scene/scripts/spacestation/space_station.tscn" id="4_5u2ds"]
[ext_resource type="Resource" uid="uid://bjsgraegcofae" path="res://planet/habitable_planet.tres" id="5_844ft"]
[ext_resource type="MeshLibrary" uid="uid://cxu8te5rwagdr" path="res://asteroid_belt.tres" id="5_pc5uv"]
[ext_resource type="Script" path="res://planet/planet_biome.gd" id="6_dcbao"]
[ext_resource type="Script" path="res://planet/planet.gd" id="7_1mo1a"]
[ext_resource type="PackedScene" uid="uid://emamuktlvdqw" path="res://planet/planet.tscn" id="7_7std1"]
[ext_resource type="Script" path="res://planet/planet_noise.gd" id="7_jyn0w"]
[ext_resource type="Script" path="res://planet/PlanetTrail.gd" id="7_mingy"]
[ext_resource type="Script" path="res://UI.gd" id="7_wap4y"]
[ext_resource type="PackedScene" uid="uid://doj10d1ep56ef" path="res://scene/scripts/ship/ship.tscn" id="7_y28xk"]
[ext_resource type="Script" path="res://planet/planet_data.gd" id="8_3f8ds"]

[sub_resource type="Shader" id="Shader_qj5vl"]
code = "
// NOTE: Shader automatically converted from Godot Engine 4.2.2.stable's PanoramaSkyMaterial.

shader_type sky;

uniform sampler2D source_panorama : filter_linear, source_color, hint_default_black;
uniform sampler2D noise_panorama : filter_linear, source_color, hint_default_black;

void sky() {
	// rotate
	vec2 c = SKY_COORDS;
	c.x += TIME * 0.001;
	COLOR = texture(source_panorama, SKY_COORDS).rgb + 0.2 * texture(noise_panorama, SKY_COORDS).rgb;
}
"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_3lnc3"]
shader = SubResource("Shader_qj5vl")
shader_parameter/source_panorama = ExtResource("1_lgks0")
shader_parameter/noise_panorama = ExtResource("1_lgks0")

[sub_resource type="Sky" id="Sky_atdwd"]
sky_material = SubResource("ShaderMaterial_3lnc3")

[sub_resource type="Environment" id="Environment_xrpxq"]
background_mode = 2
background_energy_multiplier = 0.8
sky = SubResource("Sky_atdwd")
glow_enabled = true
glow_bloom = 0.2
glow_blend_mode = 1
adjustment_enabled = true
adjustment_brightness = 1.05
adjustment_contrast = 1.05
adjustment_saturation = 1.3

[sub_resource type="FastNoiseLite" id="FastNoiseLite_yyyb3"]
fractal_octaves = 2
fractal_lacunarity = 7.18
fractal_gain = 7.145
fractal_weighted_strength = 0.88
domain_warp_enabled = true
domain_warp_type = 1
domain_warp_frequency = 5.175
domain_warp_fractal_type = 2
domain_warp_fractal_octaves = 1

[sub_resource type="Gradient" id="Gradient_4ytiu"]
colors = PackedColorArray(1, 0, 0.0196078, 1, 0.31949, 0.0521335, 0.0792992, 1)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_jdj1o"]
gradient = SubResource("Gradient_4ytiu")

[sub_resource type="Resource" id="Resource_wie0y"]
script = ExtResource("6_dcbao")
gradient = SubResource("GradientTexture1D_jdj1o")
start_height = 0.1

[sub_resource type="Gradient" id="Gradient_o88b1"]
colors = PackedColorArray(0, 0, 0, 1, 0.902973, 0.583192, 0.129458, 1)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_6n54y"]
gradient = SubResource("Gradient_o88b1")

[sub_resource type="Resource" id="Resource_1aury"]
script = ExtResource("6_dcbao")
gradient = SubResource("GradientTexture1D_6n54y")
start_height = 1.0

[sub_resource type="Gradient" id="Gradient_3ma36"]
offsets = PackedFloat32Array(1)
colors = PackedColorArray(1, 0, 0, 1)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_pijmm"]
gradient = SubResource("Gradient_3ma36")

[sub_resource type="Resource" id="Resource_tg0hq"]
script = ExtResource("6_dcbao")
gradient = SubResource("GradientTexture1D_pijmm")
start_height = 0.5

[sub_resource type="FastNoiseLite" id="FastNoiseLite_qrpro"]
fractal_gain = 0.6

[sub_resource type="Resource" id="Resource_d7t7l"]
script = ExtResource("7_jyn0w")
min_height = 0.2
amplitude = 1.0
noise_map = SubResource("FastNoiseLite_qrpro")
use_first_layer_as_mask = false

[sub_resource type="FastNoiseLite" id="FastNoiseLite_h6wde"]
frequency = 0.0001
fractal_type = 2
fractal_octaves = 8
fractal_lacunarity = 3.34

[sub_resource type="Resource" id="Resource_x1fwu"]
script = ExtResource("7_jyn0w")
min_height = 0.8
amplitude = 0.5
noise_map = SubResource("FastNoiseLite_h6wde")
use_first_layer_as_mask = true

[sub_resource type="Resource" id="Resource_05sae"]
script = ExtResource("8_3f8ds")
radius = 5000
resolution = 10
planet_noise = Array[ExtResource("7_jyn0w")]([SubResource("Resource_d7t7l"), SubResource("Resource_x1fwu")])
biomes = Array[ExtResource("6_dcbao")]([SubResource("Resource_wie0y"), SubResource("Resource_1aury"), SubResource("Resource_tg0hq")])
biome_noise = SubResource("FastNoiseLite_yyyb3")
biome_amplitude = 1.0
biome_offset = 0.0
biome_blend = 2.0
min_height = 99999.0
max_height = 0.0

[sub_resource type="SphereShape3D" id="SphereShape3D_tms42"]
radius = 6000.0

[sub_resource type="ImmediateMesh" id="ImmediateMesh_h6dsy"]

[sub_resource type="Resource" id="Resource_5fgyq"]
resource_local_to_scene = true
script = ExtResource("8_3f8ds")
radius = 75
resolution = 40
planet_noise = Array[ExtResource("7_jyn0w")]([SubResource("Resource_d7t7l"), SubResource("Resource_x1fwu")])
biomes = Array[ExtResource("6_dcbao")]([SubResource("Resource_wie0y"), SubResource("Resource_1aury"), SubResource("Resource_tg0hq")])
biome_noise = SubResource("FastNoiseLite_yyyb3")
biome_amplitude = 1.0
biome_offset = 0.0
biome_blend = 2.0
min_height = 129.881
max_height = 157.121

[sub_resource type="SphereShape3D" id="SphereShape3D_cawu4"]
radius = 150.0

[sub_resource type="Resource" id="Resource_uekkj"]
resource_local_to_scene = true
script = ExtResource("8_3f8ds")
radius = 75
resolution = 40
planet_noise = Array[ExtResource("7_jyn0w")]([SubResource("Resource_d7t7l"), SubResource("Resource_x1fwu")])
biomes = Array[ExtResource("6_dcbao")]([SubResource("Resource_wie0y"), SubResource("Resource_1aury"), SubResource("Resource_tg0hq")])
biome_noise = SubResource("FastNoiseLite_yyyb3")
biome_amplitude = 1.0
biome_offset = 0.0
biome_blend = 2.0
min_height = 129.881
max_height = 157.121

[sub_resource type="Animation" id="Animation_6vnod"]
resource_name = "rotate"
length = 150.0
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 150.7),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0, 0, 0), Vector3(0, -6.28319, 0)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_1cihw"]
_data = {
"rotate": SubResource("Animation_6vnod")
}

[sub_resource type="SphereShape3D" id="SphereShape3D_gn006"]
radius = 3000.0

[sub_resource type="ImmediateMesh" id="ImmediateMesh_jyc8c"]

[sub_resource type="PlaneMesh" id="PlaneMesh_a4e6g"]
size = Vector2(200, 5000)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_rir6d"]
albedo_color = Color(0.215686, 1, 1, 1)

[node name="World" type="Node3D"]

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_xrpxq")

[node name="SolarSystem" type="Node3D" parent="."]

[node name="StarBody" type="RigidBody3D" parent="SolarSystem"]
mass = 3000.0
script = ExtResource("7_1mo1a")
planet_data = SubResource("Resource_05sae")

[node name="Star" parent="SolarSystem/StarBody" instance=ExtResource("3_ry3cy")]
cast_shadow = 0
skeleton = NodePath("../../..")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="SolarSystem/StarBody/Star"]
transform = Transform3D(-0.866025, 0.25, 0.433013, 1.51421e-07, 0.866025, -0.5, -0.5, -0.433012, -0.75, 0, 0, 0)
light_color = Color(1, 0.545098, 0.247059, 1)
shadow_enabled = true
shadow_opacity = 0.9
shadow_blur = 0.4
directional_shadow_max_distance = 100000.0

[node name="CollisionShape3D" type="CollisionShape3D" parent="SolarSystem/StarBody"]
shape = SubResource("SphereShape3D_tms42")

[node name="PlanetTrail" type="MeshInstance3D" parent="SolarSystem/StarBody"]
mesh = SubResource("ImmediateMesh_h6dsy")

[node name="OrbitAnchor4" type="Node3D" parent="SolarSystem"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3070.12, 0, 1063.68)
script = ExtResource("3_2ho2d")
rotation_speed = 0.2

[node name="MoonOrbit" type="Node3D" parent="SolarSystem/OrbitAnchor4"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 46779, 215.95, -2973.34)
script = ExtResource("3_2ho2d")

[node name="Moon" parent="SolarSystem/OrbitAnchor4/MoonOrbit" instance=ExtResource("7_7std1")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -22919.2, 215.95, -31.0896)
mass = 100.0
linear_velocity = Vector3(10, 0, 0)
initial_velocity = Vector3(10, 0, 0)
planet_data = SubResource("Resource_5fgyq")

[node name="CollisionShape3D" type="CollisionShape3D" parent="SolarSystem/OrbitAnchor4/MoonOrbit/Moon"]
shape = SubResource("SphereShape3D_cawu4")

[node name="PlanetTrail" type="MeshInstance3D" parent="SolarSystem/OrbitAnchor4/MoonOrbit/Moon"]

[node name="Moon2Orbit" type="Node3D" parent="SolarSystem/OrbitAnchor4"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 46779, 215.95, -2973.34)
script = ExtResource("3_2ho2d")
rotation_speed = 0.08

[node name="Moon" parent="SolarSystem/OrbitAnchor4/Moon2Orbit" instance=ExtResource("7_7std1")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 34893.5, 215.95, -275.695)
mass = 100.0
linear_velocity = Vector3(10, 0, 0)
initial_velocity = Vector3(10, 0, 0)
planet_data = SubResource("Resource_uekkj")

[node name="CollisionShape3D2" type="CollisionShape3D" parent="SolarSystem/OrbitAnchor4/Moon2Orbit/Moon"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -57812.7, 0, 244.605)
shape = SubResource("SphereShape3D_cawu4")

[node name="PlanetTrail" type="MeshInstance3D" parent="SolarSystem/OrbitAnchor4/Moon2Orbit/Moon"]

[node name="Planet" parent="SolarSystem/OrbitAnchor4" instance=ExtResource("7_7std1")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 46779, 215.95, -2973.34)
mass = 200.0
linear_velocity = Vector3(30, 0, 0)
initial_velocity = Vector3(30, 0, 0)
planet_data = ExtResource("5_844ft")

[node name="SpaceStationOrbit" type="Node3D" parent="SolarSystem/OrbitAnchor4/Planet"]

[node name="SpaceStation" parent="SolarSystem/OrbitAnchor4/Planet/SpaceStationOrbit" instance=ExtResource("4_5u2ds")]
transform = Transform3D(-40.4504, 0, 29.3899, 0, 50, 0, -29.3899, 0, -40.4504, -14763.6, 54.9302, -18.2751)

[node name="GridMap" type="GridMap" parent="SolarSystem/OrbitAnchor4/Planet/SpaceStationOrbit/SpaceStation"]
transform = Transform3D(-0.809008, 0, -0.587798, 0, 1, 0, 0.587798, 0, -0.809008, 0, 0, 0)
visible = false
mesh_library = ExtResource("5_pc5uv")
cell_size = Vector3(5, 5, 5)
data = {
"cells": PackedInt32Array(1, 13, 1114112, 12, 5, 786432, 15, 65531, 983040, 10, 65522, 196608, 1, 65521, 131072, 65529, 65524, 1179648, 65520, 65527, 524288, 65518, 0, 720896, 65526, 12, 655360, 131060, 6, 1048576, 131060, 65533, 1245184, 131060, 65524, 262144, 65536, 65518, 458752, 65550, 65524, 720896, 65554, 65533, 196608, 65544, 6, 131072, 65543, 11, 1179648, 131066, 15, 1114112, -16, 11, 1114112, -21, 3, 786432, -13, 65527, 983040, -1, 65522, 196608, -65530, 65517, 131072, -65517, 65527, 1179648, -65520, 1, 720896, -65532, 10, 720896, 65522, 9, 720898, 65516, 7, 983042, 65520, 4, 917506, 65515, 65533, 1245186, 65518, 65531, 1179650, 65520, 65524, 1114114, 65526, 65526, 786434, 65527, 65520, 983042, 65532, 65521, 196610, 3, 65522, 131074, 3, 65519, 1179650, 9, 65521, 1114114, 14, 65527, 786434, 18, 65528, 983042, 16, 65534, 196610, 12, 1, 131074, 6, 9, 1179650, 10, 9, 1114114, 65533, 14, 786434, 65528, 13, 983042, 131056, 8, 983042, 131054, 2, 196610, 131057, 65533, 131074, 131059, 65529, 1179650, 131062, 65524, 1114114, 131069, 65522, 786434, 65541, 65523, 983042, 65549, 65526, 196610, 65551, 0, 131074, 65538, 10, 1179650, 131067, 13, 1114114, 131059, 11, 786434)
}
metadata/_editor_floor_ = Vector3(0, 0, 0)

[node name="AnimationPlayer" type="AnimationPlayer" parent="SolarSystem/OrbitAnchor4/Planet/SpaceStationOrbit/SpaceStation/GridMap"]
libraries = {
"": SubResource("AnimationLibrary_1cihw")
}

[node name="CollisionShape3D" type="CollisionShape3D" parent="SolarSystem/OrbitAnchor4/Planet"]
shape = SubResource("SphereShape3D_gn006")

[node name="PlanetTrail" type="MeshInstance3D" parent="SolarSystem/OrbitAnchor4/Planet"]
mesh = SubResource("ImmediateMesh_jyc8c")
script = ExtResource("7_mingy")

[node name="UI" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0
script = ExtResource("7_wap4y")

[node name="Follower" type="Label" parent="UI"]
layout_mode = 0
offset_left = 549.0
offset_top = 3.0
offset_right = 828.0
offset_bottom = 26.0

[node name="Speed" type="Label" parent="UI"]
layout_mode = 0
offset_right = 40.0
offset_bottom = 23.0

[node name="OwnShip" type="Label" parent="UI"]
layout_mode = 0
offset_left = 5.0
offset_top = 143.0
offset_right = 243.0
offset_bottom = 166.0

[node name="Plane" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 43000, 200, -2000)
visible = false
mesh = SubResource("PlaneMesh_a4e6g")
surface_material_override/0 = SubResource("StandardMaterial3D_rir6d")

[node name="Ship" parent="." groups=["ship"] instance=ExtResource("7_y28xk")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -43708.1, 4231.39, 1913.11)
max_speed = 3000.0
throttle = 350.0
